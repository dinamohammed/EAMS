<?xml version="1.0" encoding="UTF-8"?>
<openerp>
    <data>

        <!-- Form Views -->
        <record id="maintenance_project_form_view" model="ir.ui.view">
            <field name="name">maintenance.project.form.view</field>
            <field name="model">maintenance.project</field>
            <field name="arch" type="xml">
                <form string="Maintenance Project">
                    <div class="oe_title">
                        <label for="name" class="oe_edit_only" string="Title"/>
                        <h1>
                            <field name="name" placeholder="Project name..."/>
                        </h1>
                    </div>
                    <group>
                        <field name="project_type_id"/>
                    </group>
                    <notebook>
                        <page name="location" string="Maintenance Location">
                            <field name="project_location_ids" nolabel="1"
                                   context="{'default_usage':'maintenance', 'default_maintenance_project_id': active_id}">
                                <tree>
                                    <field name="name"/>
                                    <field name="usage"/>
                                    <field name="maintenance_project_id"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </form>
            </field>
        </record>

        <record id="view_maintenance_location_form_inherit" model="ir.ui.view">
            <field name="name">stock.location.form.inherit</field>
            <field name="model">stock.location</field>
            <field name="inherit_id" ref="stock.view_location_form"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='return_location']" position="after">
                    <field name="maintenance_project_id"
                           attrs="{'invisible': [('usage', '!=', 'maintenance')]}"/>
                </xpath>
                <xpath expr="//field[@name='return_location']" position="attributes">
                    <attribute name="attrs">{'invisible': [('usage', '=', 'maintenance')]}</attribute>
                </xpath>
                <xpath expr="//field[@name='comment']" position="after">
                    <notebook attrs="{'invisible': [('usage', '!=', 'maintenance')]}">
                        <page string="Maintenance Equipments">
                            <field name="maintenance_equipment_ids" nolable="1">
                                <tree>
                                    <field name="name"/>
                                    <field name="maintenance_project_id"/>
                                    <field name="stock_location_id"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </xpath>
            </field>
        </record>

        <record id="maintenance_project_equipment_form_view" model="ir.ui.view">
            <field name="name">maintenance.project.equipment.form.view</field>
            <field name="model">maintenance.project.equipment</field>
            <field name="arch" type="xml">
                <form string="Project Equipment">
                    <div class="oe_title">
                        <label for="name" class="oe_edit_only" string="Title"/>
                        <h1>
                            <field name="name" placeholder="Equipment name..."/>
                        </h1>
                    </div>
                    <group>
                        <field name="maintenance_project_id" options="{'no_create': True, 'no_create_edit':True}"/>
                        <field name="stock_location_id"/>
                    </group>
                    <notebook>
                        <page name="parts" string="Parts">
                            <field name="equipment_part_ids">
                                <tree>
                                    <field name="product_id"/>
                                    <field name="qty"/>
                                    <field name="product_stock"/>
                                    <field name="categ_id"/>
                                </tree>
                            </field>
                        </page>
                        <page name="tasks" string="Tasks">
                            <field name="task_ids" context="{'default_equipment_id': active_id}">
                                <tree editable="bottom">
                                    <field name="name"/>
<!--                                    <field name="project_id"/>-->
<!--                                    <field name="location_id"/>-->
                                    <field name="task_categ_id"/>
                                    <field name="equipment_id"/>
                                    <field name="task_categ_id"/>
                                    <field name="date"/>
                                    <field name="state"/>
                                    <field name="note"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </form>
            </field>
        </record>

        <record id="maintenance_equipment_part_form_view" model="ir.ui.view">
            <field name="name">maintenance.equipment.part.form.view</field>
            <field name="model">maintenance.equipment.parts</field>
            <field name="arch" type="xml">
                <form string="Project Equipment">
                    <div class="oe_title">
                        <label for="product_id" class="oe_edit_only" string="Product"/>
                        <h1>
                            <field name="product_id" placeholder="Part ..."/>
                        </h1>
                    </div>
                    <group>
                        <field name="qty"/>
                        <field name="product_stock"/>
                        <field name="categ_id"/>
                    </group>
                </form>
            </field>
        </record>

        <!-- Tree Views -->
        <record id="maintenance_project_equipment_tree_view" model="ir.ui.view">
            <field name="name">maintenance.project.equipment.tree.view</field>
            <field name="model">maintenance.project.equipment</field>
            <field name="arch" type="xml">
                <tree string="Projects Equipments" multi_edit="1" sample="1">
                    <field name="name" string="Equipment Name"/>
                    <field name="stock_location_id"/>
                    <field name="maintenance_project_id"/>
                </tree>
            </field>
        </record>

        <!-- Actions -->
        <record id="maintenance_project_configuration_action" model="ir.actions.act_window">
            <field name="name">Project</field>
            <field name="res_model">maintenance.project</field>
            <field name="view_mode">kanban,tree,form</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Add a new project in the maintenance request
                </p>
            </field>
        </record>

        <record id="project_type_action" model="ir.actions.act_window">
            <field name="name">Project Type</field>
            <field name="res_model">maintenance.project.type</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Add a new project type
                </p>
            </field>
        </record>

        <record id="project_location_action" model="ir.actions.act_window">
            <field name="name">Project Location</field>
            <field name="res_model">stock.location</field>
            <field name="context">{'default_usage': 'maintenance'}</field>
            <field name="domain">[('usage','=','maintenance')]</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Add a new project location
                </p>
            </field>
        </record>

        <record id="maintenance_project_equipment_action" model="ir.actions.act_window">
            <field name="name">Maintenance Project Equipment</field>
            <field name="res_model">maintenance.project.equipment</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Add a new project equipment
                </p>
            </field>
        </record>

        <record id="equipment_parts_action" model="ir.actions.act_window">
            <field name="name">Equipment Parts</field>
            <field name="res_model">maintenance.equipment.parts</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Add a new project equipment part
                </p>
            </field>
        </record>

        <record id="maintenance_task_configuration_action" model="ir.actions.act_window">
            <field name="name">Task</field>
            <field name="res_model">maintenance.task</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Add a new maintenance task
                </p>
            </field>
        </record>

        <record id="maintenance_task_categ_configuration_action" model="ir.actions.act_window">
            <field name="name">Task Category</field>
            <field name="res_model">task.categ</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Add a new maintenance task category
                </p>
            </field>
        </record>

        <record id="maintenance_task_line_action" model="ir.actions.act_window">
            <field name="name">Task Line</field>
            <field name="res_model">maintenance.task.line</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Add a new maintenance task category
                </p>
            </field>
        </record>

        <!-- Menu items -->
        <menuitem
                id="menu_project_configuration"
                name="Project"
                parent="maintenance.menu_maintenance_configuration"
                groups="maintenance.group_equipment_manager"
                sequence="5"/>

        <menuitem
                id="menu_project_details_configuration"
                name="Project"
                parent="menu_project_configuration"
                action="maintenance_project_configuration_action"
                groups="maintenance.group_equipment_manager"
                sequence="1"/>

        <menuitem
                id="project_type_menu"
                name="Project Type"
                parent="menu_project_configuration"
                action="project_type_action"
                groups="maintenance.group_equipment_manager"
                sequence="2"/>

        <menuitem
                id="project_locations_menu"
                name="Project Locations"
                parent="menu_project_configuration"
                action="project_location_action"
                groups="maintenance.group_equipment_manager"
                sequence="3"/>

        <menuitem
                id="maintenance_project_equipment_menu"
                name="Project Equipment"
                parent="menu_project_configuration"
                action="maintenance_project_equipment_action"
                groups="maintenance.group_equipment_manager"
                sequence="4"/>

        <menuitem
                id="equipment_parts_menu"
                name="Parts"
                parent="menu_project_configuration"
                action="equipment_parts_action"
                groups="maintenance.group_equipment_manager"
                sequence="5"/>


        <menuitem
                id="menu_main_task_configuration"
                name="Tasks"
                parent="maintenance.menu_maintenance_configuration"
                groups="maintenance.group_equipment_manager"
                sequence="6"/>

        <menuitem
                id="menu_task_configuration"
                name="Task"
                parent="menu_main_task_configuration"
                action="maintenance_task_configuration_action"
                groups="maintenance.group_equipment_manager"
                sequence="1"/>

        <menuitem
                id="menu_task_categ_configuration"
                name="Task Category"
                parent="menu_main_task_configuration"
                action="maintenance_task_categ_configuration_action"
                groups="maintenance.group_equipment_manager"
                sequence="2"/>

        <menuitem
                id="menu_task_task_line"
                name="Task Line"
                parent="maintenance.menu_maintenance_title"
                action="maintenance_task_line_action"
                groups="maintenance.group_equipment_manager"
                sequence="3"/>

    </data>
</openerp>
