<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <!--Project-->
    <!-- Project: Form view-->
    <record id="maintenance_project_form_view" model="ir.ui.view">
        <field name="name">maintenance.project.form.view</field>
        <field name="model">maintenance.project</field>
        <field name="arch" type="xml">
            <form string="Maintenance Project">
                <div class="oe_title">
                    <label for="name" class="oe_edit_only" string="Title"/>
                    <h1>
                        <field name="name" placeholder="Project name..."/>
                    </h1>
                </div>
                <group>
                    <field name="project_type_id"/>
                </group>
                <notebook>
                    <page name="location" string="Maintenance Location">
                        <field name="location_ids" nolabel="1"
                               context="{'default_usage':'maintenance', 'default_project_id': active_id}">
                            <tree>
                                <field name="name"/>
                                <field name="usage"/>
                                <field name="project_id"/>
                            </tree>
                        </field>
                    </page>
                </notebook>
            </form>
        </field>
    </record>

    <!-- Project: Tree view-->
    <record id="maintenance_project_view_tree" model="ir.ui.view">
        <field name="name">maintenance.project.tree</field>
        <field name="model">maintenance.project</field>
        <field name="arch" type="xml">
            <tree string="Maintenance Project">
                <field name="name"/>
                <field name="project_type_id"/>
            </tree>
        </field>
    </record>

    <!-- Project: Action -->
    <record id="maintenance_project_configuration_action" model="ir.actions.act_window">
        <field name="name">Project</field>
        <field name="res_model">maintenance.project</field>
        <field name="view_mode">kanban,tree,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Add a new project in the maintenance request
            </p>
        </field>
    </record>

    <!-- Project Type: Action -->
    <record id="project_type_action" model="ir.actions.act_window">
        <field name="name">Project Type</field>
        <field name="res_model">maintenance.project.type</field>
        <field name="view_mode">tree,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Add a new project type
            </p>
        </field>
    </record>


    <!--Location-->
    <!-- Location: Form view inherit -->
    <record id="view_maintenance_location_form_inherit" model="ir.ui.view">
        <field name="name">stock.location.form.inherit</field>
        <field name="model">stock.location</field>
        <field name="inherit_id" ref="stock.view_location_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='return_location']" position="after">
                <field name="project_id" readonly="1"
                       attrs="{'invisible': [('usage', '!=', 'maintenance')]}"/>
            </xpath>
            <xpath expr="//field[@name='return_location']" position="attributes">
                <attribute name="attrs">{'invisible': [('usage', '=', 'maintenance')]}</attribute>
            </xpath>
            <xpath expr="//field[@name='comment']" position="after">
                <notebook attrs="{'invisible': [('usage', '!=', 'maintenance')]}">
                    <page string="Maintenance Equipments">
                        <field name="equipment_ids" nolable="1">
                            <tree>
                                <field name="name"/>
                                <field name="project_id"/>
                                <field name="location_id"/>
                            </tree>
                        </field>
                    </page>
                </notebook>
            </xpath>
            <field name="usage" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
        </field>
    </record>

    <!-- Location: Tree view inherit -->
    <record id="maintenance_stock_location_view_tree_inherit" model="ir.ui.view">
        <field name="name">maintenance.stock.location.tree.inherit</field>
        <field name="model">stock.location</field>
        <field name="inherit_id" ref="stock.view_location_tree2"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='usage']" position="after">
                <field name="project_id" attrs="{'invisible': [('usage', '!=', 'maintenance')]}"/>
            </xpath>
        </field>
    </record>

    <!-- Location: Action -->
    <record id="project_location_action" model="ir.actions.act_window">
        <field name="name">Project Location</field>
        <field name="res_model">stock.location</field>
        <field name="context">{'default_usage': 'maintenance'}</field>
        <field name="domain">[('usage','=','maintenance')]</field>
        <field name="view_mode">tree,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Add a new project location
            </p>
        </field>
    </record>


    <!--Equipment-->
    <!-- Equipment: Form view Inherit -->
    <record id="maintenance_equipment_view_form_inherit" model="ir.ui.view">
        <field name="name">maintenance.equipment.view.form.inherit</field>
        <field name="model">maintenance.equipment</field>
        <field name="inherit_id" ref="maintenance.hr_equipment_view_form"/>
        <field name="arch" type="xml">
            <form position="attributes">
                <attribute name="create">false</attribute>
            </form>
            <xpath expr="//field[@name='category_id']" position="after">
                <field name="project_id"/>
                <field name="location_id" readonly="1"/>
            </xpath>
            <xpath expr="//page[@name='description']" position="before">
                <page name="parts" string="Parts">
                    <field name="part_ids">
                        <tree>
                            <field name="product_id"/>
                            <field name="qty"/>
                            <field name="product_stock"/>
                            <field name="categ_id"/>
                        </tree>
                    </field>
                </page>
                <page name="tasks" string="Tasks">
                    <field name="task_ids" context="{'default_equipment_id': active_id}">
                        <tree editable="bottom">
                            <field name="name"/>
                            <field name="task_categ_id"/>
                            <field name="task_id"/>
                        </tree>
                    </field>
                </page>
            </xpath>
        </field>
    </record>

    <!-- Equipment: Kanban View Inherit -->
    <record id="maintenance_equipment_view_kanban_inherit" model="ir.ui.view">
        <field name="name">maintenance.equipment.view.kanban.inherit</field>
        <field name="model">maintenance.equipment</field>
        <field name="inherit_id" ref="maintenance.hr_equipment_view_kanban"/>
        <field name="arch" type="xml">
            <kanban position="attributes">
                <attribute name="create">false</attribute>
            </kanban>
        </field>
    </record>

    <!-- Equipment: Tree View Inherit -->
    <record id="maintenance_equipment_view_tree_inherit" model="ir.ui.view">
        <field name="name">maintenance.equipment.view.tree.inherit</field>
        <field name="model">maintenance.equipment</field>
        <field name="inherit_id" ref="maintenance.hr_equipment_view_tree"/>
        <field name="arch" type="xml">
            <tree position="attributes">
                <attribute name="create">false</attribute>
            </tree>
            <xpath expr="//field[@name='name']" position="after">
                <field name="project_id"/>
                <field name="location_id"/>
            </xpath>
        </field>
    </record>

    <!--Parts-->
    <!-- Parts: Form View -->
    <record id="maintenance_equipment_part_form_view" model="ir.ui.view">
        <field name="name">maintenance.equipment.part.form.view</field>
        <field name="model">maintenance.equipment.parts</field>
        <field name="arch" type="xml">
            <form string="Project Equipment" create="false">
                <div class="oe_title">
                    <label for="product_id" class="oe_edit_only" string="Product"/>
                    <h1>
                        <field name="product_id" placeholder="Part ..."
                               options="{'no_create': True, 'no_open': True}"/>
                    </h1>
                </div>
                <group>
                    <group>
                        <field name="categ_id"/>
                        <field name="product_stock"/>
                    </group>
                    <group>
                        <field name="project_id"/>
                        <field name="location_id"/>
                        <field name="equipment_id" readonly="1"/>
                    </group>
                </group>
            </form>
        </field>
    </record>

    <!-- Parts: Tree View -->
    <record id="maintenance_equipment_part_view_tree" model="ir.ui.view">
        <field name="name">maintenance.equipment.parts.tree</field>
        <field name="model">maintenance.equipment.parts</field>
        <field name="arch" type="xml">
            <tree string="Parts" create="false">
                <field name="product_id"/>
                <field name="categ_id"/>
                <field name="project_id"/>
                <field name="location_id"/>
                <field name="equipment_id"/>
                <field name="product_stock"/>
            </tree>
        </field>
    </record>

    <!-- Parts: Action-->
    <record id="equipment_parts_action" model="ir.actions.act_window">
        <field name="name">Equipment Parts</field>
        <field name="res_model">maintenance.equipment.parts</field>
        <field name="view_mode">tree,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Add a new project equipment part
            </p>
        </field>
    </record>

    <!--Task Lines-->
    <!-- Task Lines: Tree View -->
    <record id="maintenance_task_line_view_tree" model="ir.ui.view">
        <field name="name">maintenance.task.line</field>
        <field name="model">maintenance.task.line</field>
        <field name="arch" type="xml">
            <tree string="Maintenance Task" editable="top" create="0" delete="0" multi_edit="1" sample="1">
                <field name="message_needaction" invisible="1"/>
                <field name="name"/>
                <field name="project_id"/>
                <field name="location_id"/>
                <field name="equipment_id" readonly="1"/>
                <field name="task_id"/>
                <field name="task_categ_id"/>
                <field name="date"/>
                <field name="state"/>
                <field name="note"/>
                <field name="activity_exception_decoration" widget="activity_exception"/>
            </tree>
        </field>
    </record>

    <!-- Task lines: Action -->
    <record id="maintenance_task_line_action" model="ir.actions.act_window">
        <field name="name">Task Line</field>
        <field name="res_model">maintenance.task.line</field>
        <field name="view_mode">tree,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Add a new maintenance task category
            </p>
        </field>
    </record>

    <!-- Task: Action -->
    <record id="maintenance_task_configuration_action" model="ir.actions.act_window">
        <field name="name">Task</field>
        <field name="res_model">maintenance.task</field>
        <field name="view_mode">tree,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Add a new maintenance task
            </p>
        </field>
    </record>

    <!-- Task Category: Action -->
    <record id="maintenance_task_categ_configuration_action" model="ir.actions.act_window">
        <field name="name">Task Category</field>
        <field name="res_model">task.categ</field>
        <field name="view_mode">tree,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Add a new maintenance task category
            </p>
        </field>
    </record>


    <!-- Menu items hierarchy -->
    <menuitem
            id="menu_project_configuration"
            name="Project"
            parent="maintenance.menu_maintenance_configuration"
            groups="maintenance.group_equipment_manager"
            sequence="5"/>

    <menuitem
            id="menu_project_details_configuration"
            name="Project"
            parent="menu_project_configuration"
            action="maintenance_project_configuration_action"
            groups="maintenance.group_equipment_manager"
            sequence="1"/>

    <menuitem
            id="project_type_menu"
            name="Project Type"
            parent="menu_project_configuration"
            action="project_type_action"
            groups="maintenance.group_equipment_manager"
            sequence="2"/>

    <menuitem
            id="project_locations_menu"
            name="Project Locations"
            parent="menu_project_configuration"
            action="project_location_action"
            groups="maintenance.group_equipment_manager"
            sequence="3"/>

    <record id="maintenance.menu_equipment_form" model="ir.ui.menu">
        <field name="parent_id" ref="menu_project_configuration"/>
        <field name="action" ref="maintenance.hr_equipment_action"/>
        <field name="sequence">4</field>
        <field name="name">Project Equipment</field>
    </record>

    <menuitem
            id="equipment_parts_menu"
            name="Project Parts"
            parent="menu_project_configuration"
            action="equipment_parts_action"
            groups="maintenance.group_equipment_manager"
            sequence="5"/>

    <menuitem
            id="menu_main_task_configuration"
            name="Tasks"
            parent="maintenance.menu_maintenance_configuration"
            groups="maintenance.group_equipment_manager"
            sequence="6"/>

    <menuitem
            id="menu_task_configuration"
            name="Task"
            parent="menu_main_task_configuration"
            action="maintenance_task_configuration_action"
            groups="maintenance.group_equipment_manager"
            sequence="1"/>

    <menuitem
            id="menu_task_categ_configuration"
            name="Task Category"
            parent="menu_main_task_configuration"
            action="maintenance_task_categ_configuration_action"
            groups="maintenance.group_equipment_manager"
            sequence="2"/>

    <menuitem
            id="menu_task_task_line"
            name="Task Line"
            parent="maintenance.menu_maintenance_title"
            action="maintenance_task_line_action"
            groups="maintenance.group_equipment_manager"
            sequence="3"/>

</odoo>
